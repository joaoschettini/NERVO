<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clube da Esquina, o álbum perfeito</title>
    <script src="js/sessao.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body onload="listar()">
    
    <header class="header">
        <a class="logo-header" href="conteudo.html"><img style="width: 52px; height: 52px;" src="assets/logo nervo N roxo sem fundo.png" alt=""></a>
        <nav class="navbar-header">
            <ul>
                <li><a href="conteudo.html#musica-semana">Música da Semana</a></li>
                <li><a href="conteudo.html#conteudo-materias">Matérias</a></li>
                <li><a href="conteudo.html#playlist-nervo">Playlist</a></li>
            </ul>
        </nav>
        <ul class="botao">
            <li><a href="perfil.html"><button>Perfil</button></a></li>
        </ul>
    </header>

    <div class="conteudo-materia-esquina">
        <div class="container-conteudo-materia-esquina">
            <div class="texto-materia-esquina">
                <h1>
                    Clube da Esquina, o álbum perfeito
                </h1>
                <p>
                    O álbum Clube da Esquina, lançado em 1972 por Milton Nascimento e Lô Borges, transcende a noção de um simples disco musical. Ele é uma obra-prima que redefiniu os caminhos da música brasileira, misturando harmoniosamente elementos da MPB, do jazz, do rock progressivo e das influências regionais de Minas Gerais. Sua importância vai além da sonoridade, pois reflete um momento histórico e cultural do Brasil, conquistando gerações e permanecendo atual décadas após seu lançamento. E claro, antes de continuar a ler, dá um play nesse ao vivo magnífico do mestre Lõ Borges performando O Trem Azul.
                </p>
                <div class="video-esquina">                    
                    <iframe width="560" height="315" src="https://www.youtube.com/embed/Xs-abkgp1Bo?si=Aa8NHcrsZDw-g-Cu" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                </div>
                <p>
                    O desenvolvimento do álbum é um mergulho em texturas sonoras que desafiam convenções e emocionam profundamente. Faixas como "Tudo que Você Podia Ser" e "O Trem Azul" ilustram a capacidade única de Milton e Lô em fundir a melancolia poética com arranjos inovadores. A forte influência da paisagem mineira é evidente não apenas nas letras, mas também nas melodias que evocam as montanhas e o interior do Brasil. Essa conexão com as raízes, aliada à ousadia de experimentar com ritmos estrangeiros, torna o álbum um testemunho da universalidade da música brasileira.
                    A participação de músicos como Beto Guedes, Wagner Tiso e Toninho Horta complementa a grandiosidade da obra. Cada um contribui com sua individualidade, criando um mosaico sonoro coeso e encantador. As letras, muitas vezes poéticas e introspectivas, exploram temas universais como amor, amizade, liberdade e resistência, ressoando em diferentes níveis com o público.
                    A longevidade de Clube da Esquina comprova sua relevância. Ele não é apenas um registro de seu tempo, mas um álbum que continua a inspirar músicos e ouvintes ao redor do mundo. Sua influência é perceptível tanto na música brasileira contemporânea quanto em artistas internacionais que reconhecem sua genialidade. Mais do que um álbum, é um movimento cultural que celebra a liberdade criativa e a beleza da diversidade musical.
                </p>
                <h2>
                    Conclusão
                </h2>
                <p>
                    Clube da Esquina não é apenas um marco na carreira de Milton Nascimento e Lô Borges, mas um pilar da música mundial. Ele transcende épocas e fronteiras, permanecendo um trabalho essencial para quem deseja compreender a riqueza e a profundidade da música brasileira. Revisitar este álbum é mais do que ouvir músicas: é uma experiência que toca a alma e celebra o poder transformador da arte.
                </p>
                <div class="dono-comentario">
                    <img src="assets/_MG_7034.jpeg" class="img-dono"></img>
                    <p>
                        João Roberto Schettini Santos
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div class="botao-like-comentario">
        <div class="container-botao-like-comentario">
            <div class="conteudo-like">
                <p>
                    Gostou dessa publicação?
                </p>
                <a onclick="curtir()" id="botao_curtida" class="botao-curtida">
                    <img src="assets/thumbs-up.png" id="img-like" class="img-like"></img>
                </a>
                <p>
                    Curta essa matéria!
                </p>
            </div>
        </div>
    </div>

    <div class="comentario-materia-esquina">
        <div class="container-comentario-esquina">
            <div class="texto-comentario-esquina">
                <div class="titulo-comentario">
                    <h1>
                        Comentários
                    </h1>
                    <p>
                        Diga suas próprias impressões sobre essa matéria!
                    </p>
                </div>
                <div class="area-comentario">
                    <textarea rows="4" type="text" id="text_comentario"></textarea>
                    <button onclick="publicar()">Publicar</button>
                </div>
                <div id="conteudo_comentario" class="conteudo-comentario"></div>
            </div>
        </div>
    </div>

    <div class="alerta_erro">
        <div class="card_erro" id="cardErro">
            <span id="mensagem_erro"></span>
        </div>
    </div>
    <div id="div_aguardar" class="loading-div">
        <!-- <img src="./assets/circle-loading.gif" id="loading-gif"> -->
    </div>

    <div id="div_erros_login"></div>

    <footer class="footer">
        <div class="footer-1">
            <a class="logo-footer" href="conteudo.html"><img style="width: 52px; height: 52px;" src="assets/logo nervo N roxo sem fundo.png" alt=""></a>
            <nav class="navbar-footer">
                <ul>
                    <li><a href="conteudo.html#musica-semana">Música da Semana</a></li>
                    <li><a href="conteudo.html#conteudo-materias">Matérias</a></li>
                    <li><a href="conteudo.html#playlist-nervo">Playlist</a></li>
                </ul>
            </nav>
        <div class="icons-footer">
            <a href="https://www.instagram.com/roaojoberto/" target="_blank" rel="noopener noreferrer">
                <svg id="icon-instagram" xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#000000" viewBox="0 0 256 256"><path d="M128,80a48,48,0,1,0,48,48A48.05,48.05,0,0,0,128,80Zm0,80a32,32,0,1,1,32-32A32,32,0,0,1,128,160ZM176,24H80A56.06,56.06,0,0,0,24,80v96a56.06,56.06,0,0,0,56,56h96a56.06,56.06,0,0,0,56-56V80A56.06,56.06,0,0,0,176,24Zm40,152a40,40,0,0,1-40,40H80a40,40,0,0,1-40-40V80A40,40,0,0,1,80,40h96a40,40,0,0,1,40,40ZM192,76a12,12,0,1,1-12-12A12,12,0,0,1,192,76Z"></path></svg>
            </a>
            <a href="https://open.spotify.com/playlist/5TB4zkfnxRfLVY9zkD1edo?si=f16580c108ae41e2" target="_blank" rel="noopener noreferrer">
                <svg id="icon-spotify" xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="#000000" viewBox="0 0 256 256"><path d="M128,24A104,104,0,1,0,232,128,104.11,104.11,0,0,0,128,24Zm0,192a88,88,0,1,1,88-88A88.1,88.1,0,0,1,128,216Zm31.07-46.26a8,8,0,0,1-10.81,3.33,42.79,42.79,0,0,0-40.52,0,8,8,0,0,1-7.48-14.14,59.33,59.33,0,0,1,55.48,0A8,8,0,0,1,159.07,169.74Zm32-56a8,8,0,0,1-10.83,3.29,110.62,110.62,0,0,0-104.46,0,8,8,0,0,1-7.54-14.12,126.67,126.67,0,0,1,119.54,0A8,8,0,0,1,191.06,113.76Zm-16,28a8,8,0,0,1-10.82,3.3,77,77,0,0,0-72.48,0,8,8,0,0,1-7.52-14.12,93,93,0,0,1,87.52,0A8,8,0,0,1,175.06,141.76Z"></path></svg>
            </a>
        </div>
        </div>
        <div class="footer-2">
            <h5>
                © 2024 Nervo. Todos os direitos reservados.
            </h5>
        </div>
    </footer>

</body>
</html>

<script>
    
    var curtida = 0
    function curtir() {
        var fkMateria = 2
        var idUsuario = sessionStorage.ID_USUARIO;

        if (curtida == 0) {
            curtida+=1
            document.getElementById("img-like").src="assets/thumbs-up-fill.png";

                fetch("/curtida/curtir", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    fkMateriaServer: fkMateria,
                    idUsuarioServer: idUsuario
                })
                })
        } else if (curtida == 1) {
            curtida-=1
            document.getElementById("img-like").src="assets/thumbs-up.png";

            fetch(`/curtida/deletar${idUsuario}`, {
            method: "DELETE",
            headers: {
                "Content-Type": "application/json"
            }
            }).then(function (resposta) {

            if (resposta.ok) {
                cardErro.style.display = "block";
                    mensagem_erro.innerHTML =
                        "Curtida deletada com sucesso pelo usuario de email: " + sessionStorage.getItem("EMAIL_USUARIO") + "!";
                    setInterval(sumirMensagem, 3000);
                    finalizarAguardar();
                    return false;
            } else if (resposta.status == 404) {
                window.alert("Deu 404!");
            } else {
                throw ("Houve um erro ao tentar realizar a postagem! Código da resposta: " + resposta.status);
            }
            }).catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
            });
        }

    }

    function publicar() {
        var comentario = text_comentario.value
        var fkMateria = 2
        var idUsuario = sessionStorage.ID_USUARIO;
        var nome = sessionStorage.NOME_USUARIO;

        if (comentario == "") {
            cardErro.style.display = "block";
            mensagem_erro.innerHTML =
                "Comente algo antes de publicar!";
            setInterval(sumirMensagem, 3000);
            finalizarAguardar();
            return false;
        } else {
            conteudo_comentario.innerHTML += `<div class="sessao-comentario">
                                            <p class="texto-comentario">
                                               ${comentario}
                                            </p>
                                            <div class="usuario-comentario">
                                            <p>
                                                - ${nome}
                                            </p>
                                        </div>
                                    </div>
                                    `
        }

        fetch("/comentario/publicar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({
                comentarioServer: comentario,
                fkMateriaServer: fkMateria,
                idUsuarioServer: idUsuario
            })
        })

    }

    function listar() {
        var fkMateria = 2

        fetch(`/comentario/listar${fkMateria}`).then(function (resposta) {
            if (resposta.ok) {
                if (resposta.status == 204) {
                    var conteudo = document.getElementById("conteudo_comentario");
                    var mensagem = document.createElement("span");
                    mensagem.innerHTML = "Nenhum resultado encontrado."
                    conteudo.appendChild(mensagem);
                    throw "Nenhum resultado encontrado!!";
                }

                resposta.json().then(function (resposta) {
                    console.log("Dados recebidos: ", JSON.stringify(resposta));

                    var conteudo = document.getElementById("conteudo_comentario");
                    conteudo.innerHTML = "";
                    for (let i = 0; i < resposta.length; i++) {
                        var publicacao = resposta[i];

                        conteudo_comentario.innerHTML += `<div class="sessao-comentario">
                                            <p class="texto-comentario">
                                               ${publicacao.conteudo}
                                            </p>
                                            <div class="usuario-comentario">
                                            <p>
                                                - ${publicacao.nome}
                                            </p>
                                        </div>
                                    </div>
                                    `

                    }


                    finalizarAguardar();
                });
            } else {
                throw ('Houve um erro na API!');
            }
        }).catch(function (resposta) {
            console.error(resposta);
            finalizarAguardar();
        });
    }

    function sumirMensagem() {
        cardErro.style.display = "none"
    }

</script>